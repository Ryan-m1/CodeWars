# ğŸ˜†RocketMQæºç é˜…è¯»ç¯å¢ƒæ­å»º

# 1.æ•™ç¨‹å¼€å§‹

## 1.1 æ‹‰å–ä»£ç 

æºç åœ°å€ï¼šhttps://github.com/apache/rocketmq

é»˜è®¤é€‰æ‹©masteråˆ†æ”¯

æ‰§è¡Œgitå‘½ä»¤

```git
git clone https://github.com/apache/rocketmq.git
```

ä½¿ç”¨IDEAå¯¼å…¥é¡¹ç›®

![image-20211013234432896](img/image-20211013234432896.png)

ä¸‹è½½ä¾èµ–ï¼Œè€å¿ƒç­‰å¾…å³å¯



## 1.2å‡†å¤‡é…ç½®æ–‡ä»¶

æœ¬æ­¥éœ€è¦ä¿®æ”¹æºç ä¸­æ—¥å¿—é…ç½®æ–‡ä»¶æŒ‡å®šè·¯å¾„ï¼Œé¿å…ç›´æ¥ä¿®æ”¹æºæ–‡ä»¶ï¼Œé€‰æ‹©æ–°å»ºç›®å½•ç”¨äºå­˜æ”¾æ—¥å¿—é…ç½®æ–‡ä»¶ã€‚



1ï¼‰ åœ¨é¡¹ç›®è·Ÿç›®å½•ä¸‹é¢æ–°å»ºä¸€ä¸ªconfæ–‡ä»¶å¤¹(ç”¨æ¥å­˜æ”¾æ—¥å¿—é…ç½®æ–‡ä»¶)ã€‚å°†è·Ÿé¡¹ç›®ä¸‹çš„distributionæ¨¡å—çš„confç›®å½•ä¸­çš„logback_broker.xmlï¼Œlogback_namesrv.xmlæ‹·è´åˆ°åˆšæ–°å»ºçš„confç›®å½•ä¸‹

![image-20211013235015241](img/image-20211013235015241.png)

ä¿®æ”¹åå¦‚ä¸‹ï¼š

![image-20211013235103423](img/image-20211013235103423.png)

2ï¼‰åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºmq_dataæ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜æ”¾rocketMQè¿è¡Œæ—¶äº§ç”Ÿçš„æ•°æ®ï¼Œå¦åˆ™äº§ç”Ÿçš„æ—¥å¿—å’Œæ¶ˆæ¯é˜Ÿåˆ—ä¼šè‡ªåŠ¨é»˜è®¤å­˜æ”¾åœ¨homeç›®å½•ä¸‹

![image-20211013235430140](img/image-20211013235430140.png)

logsç›®å½•ç”¨äºå­˜æ”¾æ—¥å¿—

storeç›®å½•ç”¨äºå­˜æ”¾æ¶ˆæ¯é˜Ÿåˆ—äº§ç”Ÿçš„æ•°æ®



## 1.3 ä¿®æ”¹é…ç½®æ–‡ä»¶

æˆ‘ä»¬æ—¢ç„¶æƒ³å°†ä¸Šè¿°æ–°å»ºçš„ç›®å½•ç”¨äºå­˜æ”¾æ—¥å¿—å’Œæ•°æ®ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¿®æ”¹æºé¡¹ç›®ä¸­é»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œä»¥è¾¾åˆ°æˆ‘ä»¬çš„è¯‰æ±‚ã€‚

æ‰¾åˆ°ç¬¬ä¸€æ­¥åœ¨æ ¹ç›®å½•ä¸‹æ–°å»ºçš„confç›®å½• ä¿®æ”¹logback_broker.xmlå’Œlogback_namesrv.xml

![image-20211013235758795](img/image-20211013235758795.png)

å°†æ–‡ä»¶ç›®å½•ä¿®æ”¹ä¸ºæœ¬æœºç›®å½•(å­˜æ”¾è¿›ä¸Šä¸€æ­¥æˆ‘ä»¬æ–°å»ºçš„ç›®å½•mq_data)

ä¸¾å…¶ä¸­ä¸€ä¸ªä¾‹å­

è¿™æ˜¯æˆ‘æœ¬æœºå­˜æ”¾æ—¥å¿—ç›®å½•

![image-20211014000107618](img/image-20211014000107618.png)

logback_broker.xmlå…¶ä¸­ä¸€è¡Œéœ€è¦ä¿®æ”¹çš„é…ç½®ä¿¡æ¯

```xml
<fileNamePattern>/Users/ryan/ProgramData/CodeFarmersTurn/rocketmq/mq_data/logs/rocketmqlogs/broker_default.%i.log.gz</fileNamePattern>
```

![image-20211014000019948](img/image-20211014000019948.png)

æ³¨æ„logback_broker.xmlå’Œlogback_namesrv.xmléƒ½éœ€è¦ä¿®æ”¹æŒ‡å®šåœ¨æˆ‘ä»¬æ–°å»ºçš„ç›®å½•ä¸‹



## 1.4 é…ç½®IDEAç¯å¢ƒå˜é‡ å¯åŠ¨Namesrv

é…ç½®æ–‡ä»¶ä¿®æ”¹å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¯åŠ¨ç¨‹åºäº†

1ï¼‰é…ç½®IDEAç¯å¢ƒå˜é‡ å¯åŠ¨Namesrv

![image-20211014000609368](img/image-20211014000609368.png)

working directoryä¿®æ”¹ä¸ºæœ¬åœ°é¡¹ç›®æ ¹ç›®å½•å³å¯

**å¯åŠ¨NamesrvStartup**

![image-20211014000722405](img/image-20211014000722405.png)

![image-20211014000744006](img/image-20211014000744006.png)

è‡³æ­¤namesrvå¯åŠ¨æˆåŠŸ

2ï¼‰å¯åŠ¨Broker

**é…ç½®IDEAçš„ç¯å¢ƒå˜é‡å’ŒJVMå‚æ•°**

![image-20211014000948659](img/image-20211014000948659.png)

![image-20211014001027630](img/image-20211014001027630.png)

æŒ‡å®šbrokerç›¸å…³å‚æ•°ï¼ŒæŒ‡å®šé…ç½®æ–‡ä»¶åœ¨ç›®å½•distribution/conf/2m-2s-sync/broker-a.propertiesä¸‹

```
-c
/Users/ryan/ProgramData/CodeFarmersTurn/rocketmq/distribution/conf/2m-2s-sync/broker-a.properties
-n
localhost:9876
```



ä¸ºæ­¤æˆ‘ä»¬éœ€è¦åœ¨broker-a.propertiesé…ç½®æ–‡ä»¶ä¸­æŒ‡å®šæ•°æ®è·¯å¾„å’Œç«¯å£

![image-20211014001229393](img/image-20211014001229393.png)

```
storePathRootDir=/Users/ryan/ProgramData/CodeFarmersTurn/rocketmq/mq_data/store/brocker-a
listenPort=20910
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥å·²ç›¸åŒçš„æ–¹å¼é…ç½®Slaver

![image-20211014001357051](img/image-20211014001357051.png)

![image-20211014001430975](img/image-20211014001430975.png)

éœ€è¦æ³¨æ„Slaveréœ€è¦ä¿®æ”¹å‚æ•°ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ æŒ‡å‘broker-a-s.properties

åŒç†broker-a-s.propertiesä¹Ÿéœ€è¦ä¿®æ”¹æŒ‡å®šæ•°æ®è·¯å¾„å’Œç«¯å£

![image-20211014001546952](img/image-20211014001546952.png)

è¿™é‡Œå…ˆè¸©ä¸€ä¸ªå‘ï¼ŒMasterå’ŒSlaverçš„ç«¯å£è®¾ç½®éœ€è¦é—´éš”å¤§ä¸€äº›ï¼Œå¦åˆ™ä¼šæŠ¥é”™

å¯ä»¥çœ‹åˆ°Masteræˆ‘è®¾ç½®çš„æ˜¯20910è€ŒSlaveræˆ‘è®¾ç½®çš„æ˜¯20920



## 1.5 å¯åŠ¨Broker

![image-20211014001843738](img/image-20211014001843738.png)

![image-20211014001902844](img/image-20211014001902844.png)

å¯ä»¥çœ‹åˆ°Masterå’ŒSlaver Brokeréƒ½å·²ç»æˆåŠŸå¯åŠ¨äº†

å¯ä»¥å†™ä¸ªå°Demoï¼Œè·‘ä¸€ä¸‹Demoçš„ä¾‹å­ï¼Œä¹‹åå°±å¯ä»¥æ„‰å¿«çš„è¿›è¡Œæºç é˜…è¯»äº†

è‡³æ­¤æœ¬æ–‡RocketMQæºç é˜…è¯»ç¯å¢ƒæ­å»ºå°±ç»“æŸäº†

***

æœ€åé™„ä¸Šä½œè€…æ­å»ºçš„RocketMQæºç é˜…è¯»ç¯å¢ƒGiteeåœ°å€ï¼Œä¾¿äºå¤§å®¶cloneä¸‹æ¥ç¿»çœ‹
[Giteeè¿æ¥](https://gitee.com/M-Analysis/rocket-mq)

***

**æœ¬æ–‡å·²æ”¶å½•åˆ°CodeWarsç³»åˆ—ï¼Œæ¬¢è¿å„ä½Starï¼ŒæŒç»­è¾“å‡ºé«˜è´¨é‡æŠ€æœ¯æ–‡ç« **
[é“¾æ¥ç‚¹æˆ‘ï¼](https://gitee.com/effective-java/CodeWars)


**æ›´å¤šæŠ€æœ¯æ–‡ç« ï¼Œè¯·å…³æ³¨å…¬ä¼—å·ï¼Œè®©æˆ‘ä»¬ä¸€èµ·è¿›æ­¥å§ï¼**

![](https://img-blog.csdnimg.cn/2020120416583873.png#pic_center#pic_center)

![image-20211014002153490](img/image-20211014002153490.png)

![image-20211014002215316](img/image-20211014002215316.png)

